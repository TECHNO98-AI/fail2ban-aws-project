<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="318px" preserveAspectRatio="none" style="width:2655px;height:318px;background:#FFFFFF;" version="1.1" viewBox="0 0 2655 318" width="2655px" zoomAndPan="magnify"><title>Fail2Ban &#8212; Cloud Security Dashboard (AWS) - Architecture</title><defs/><g><rect fill="#FFFFCC" height="26.6406" rx="2.5" ry="2.5" style="stroke:#FFDD88;stroke-width:3;" width="2644.4969" x="5" y="5"/><text fill="#000000" font-family="monospace" font-size="10" lengthAdjust="spacing" textLength="355.21" x="10" y="20">Please&#160;use&#160;'!option&#160;handwritten&#160;true'&#160;to&#160;enable&#160;handwritten</text><g class="title" data-source-line="1"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="424.1357" x="1101.1806" y="60.1758">Fail2Ban &#8212; Cloud Security Dashboard (AWS) - Architecture</text></g><!--entity Fail2Ban--><g class="entity" data-entity="Fail2Ban" data-source-line="6" data-uid="ent0002" id="entity_Fail2Ban"><ellipse cx="55.9263" cy="111.6289" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M55.9263,119.6289 L55.9263,146.6289 M42.9263,127.6289 L68.9263,127.6289 M55.9263,146.6289 L42.9263,161.6289 M55.9263,146.6289 L68.9263,161.6289" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.8525" x="6" y="176.6641">Fail2Ban (host)</text></g><!--entity CWLogs--><g class="entity" data-entity="CWLogs" data-source-line="7" data-uid="ent0003" id="entity_CWLogs"><polygon fill="#F1F1F1" points="455.85,128.1289,465.85,118.1289,612.8471,118.1289,612.8471,154.6172,602.8471,164.6172,455.85,164.6172,455.85,128.1289" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="602.8471" x2="612.8471" y1="128.1289" y2="118.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="455.85" x2="602.8471" y1="128.1289" y2="128.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="602.8471" x2="602.8471" y1="128.1289" y2="164.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.9971" x="470.85" y="151.6641">CloudWatch Logs</text></g><!--entity MetricFilter--><g class="entity" data-entity="MetricFilter" data-source-line="8" data-uid="ent0004" id="entity_MetricFilter"><polygon fill="#F1F1F1" points="896.85,128.1289,906.85,118.1289,1102.7514,118.1289,1102.7514,154.6172,1092.7514,164.6172,896.85,164.6172,896.85,128.1289" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1092.7514" x2="1102.7514" y1="128.1289" y2="118.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="896.85" x2="1092.7514" y1="128.1289" y2="128.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="1092.7514" x2="1092.7514" y1="128.1289" y2="164.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165.9014" x="911.85" y="151.6641">CloudWatch Metric Filter</text></g><!--entity Alarm--><g class="entity" data-entity="Alarm" data-source-line="9" data-uid="ent0005" id="entity_Alarm"><polygon fill="#F1F1F1" points="1308.49,128.1289,1318.49,118.1289,1473.7927,118.1289,1473.7927,154.6172,1463.7927,164.6172,1308.49,164.6172,1308.49,128.1289" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1463.7927" x2="1473.7927" y1="128.1289" y2="118.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="1308.49" x2="1463.7927" y1="128.1289" y2="128.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="1463.7927" x2="1463.7927" y1="128.1289" y2="164.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.3027" x="1323.49" y="151.6641">CloudWatch Alarm</text></g><!--entity SNS--><g class="entity" data-entity="SNS" data-source-line="10" data-uid="ent0006" id="entity_SNS"><polygon fill="#F1F1F1" points="1871.58,90.1289,1881.58,80.1289,1978.914,80.1289,1978.914,116.6172,1968.914,126.6172,1871.58,126.6172,1871.58,90.1289" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="1968.914" x2="1978.914" y1="90.1289" y2="80.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="1871.58" x2="1968.914" y1="90.1289" y2="90.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="1968.914" x2="1968.914" y1="90.1289" y2="126.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.334" x="1886.58" y="113.6641">SNS Topic</text></g><!--entity NOTIFIER--><g class="entity" data-entity="NOTIFIER" data-source-line="11" data-uid="ent0007" id="entity_NOTIFIER"><polygon fill="#F1F1F1" points="2362.1,90.1289,2372.1,80.1289,2571.3715,80.1289,2571.3715,116.6172,2561.3715,126.6172,2362.1,126.6172,2362.1,90.1289" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2561.3715" x2="2571.3715" y1="90.1289" y2="80.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="2362.1" x2="2561.3715" y1="90.1289" y2="90.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="2561.3715" x2="2561.3715" y1="90.1289" y2="126.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169.2715" x="2377.1" y="113.6641">Email / Webhook / Pager</text></g><!--entity Lambda--><g class="entity" data-entity="Lambda" data-source-line="12" data-uid="ent0008" id="entity_Lambda"><polygon fill="#F1F1F1" points="1787.52,184.1289,1797.52,174.1289,2062.9634,174.1289,2062.9634,210.6172,2052.9634,220.6172,1787.52,220.6172,1787.52,184.1289" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="2052.9634" x2="2062.9634" y1="184.1289" y2="174.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="1787.52" x2="2052.9634" y1="184.1289" y2="184.1289"/><line style="stroke:#181818;stroke-width:0.5;" x1="2052.9634" x2="2052.9634" y1="184.1289" y2="220.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235.4434" x="1802.52" y="207.6641">Lambda (auto-block / enrichment)</text></g><!--entity S3--><g class="entity" data-entity="S3" data-source-line="13" data-uid="ent0009" id="entity_S3"><path d="M1851.11,265.6289 C1851.11,255.6289 1925.2482,255.6289 1925.2482,255.6289 C1925.2482,255.6289 1999.3864,255.6289 1999.3864,265.6289 L1999.3864,291.1172 C1999.3864,301.1172 1925.2482,301.1172 1925.2482,301.1172 C1925.2482,301.1172 1851.11,301.1172 1851.11,291.1172 L1851.11,265.6289" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M1851.11,265.6289 C1851.11,275.6289 1925.2482,275.6289 1925.2482,275.6289 C1925.2482,275.6289 1999.3864,275.6289 1999.3864,265.6289" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.2764" x="1861.11" y="293.1641">S3 (artifact bucket)</text></g><!--entity GHActions--><g class="entity" data-entity="GHActions" data-source-line="14" data-uid="ent0010" id="entity_GHActions"><path d="M1309.8995,226.4449 C1313.2746,221.233 1318.4906,221.1096 1321.6294,226.7014 C1323.7519,221.0893 1328.7625,220.4331 1332.5747,224.8591 C1336.802,219.0008 1340.8683,218.4299 1344.7508,225.1918 C1347.5541,218.5976 1353.5141,218.7871 1357.4435,223.9791 C1360.4741,219.0609 1365.2052,218.8535 1367.7399,224.464 C1371.7731,218.5163 1376.1656,217.899 1380.2346,224.4281 C1382.2734,218.3391 1388.1964,217.5186 1392.1583,222.3233 C1396.46,217.1055 1400.6993,216.5873 1404.6798,222.6789 C1408.4831,217.9715 1412.2087,218.1962 1415.3095,223.4301 C1419.8946,218.389 1424.4214,216.893 1428.2117,224.2568 C1432.6488,218.3433 1437.2772,219.3379 1440.3203,225.6386 C1443.6257,220.3618 1449.2537,221.2967 1451.8517,226.4228 C1454.7293,221.0087 1459.7359,220.3365 1463.2397,225.765 C1466.0997,220.8387 1471.3467,220.7961 1474.4304,225.5051 C1485.3132,225.4628 1489.3808,233.7912 1483.034,242.481 C1486.9464,250.6051 1483.7694,256.9653 1474.1526,256.5469 C1470.9285,261.9404 1466.9403,261.9219 1463.6856,256.5767 C1460.5843,262.9524 1456.1496,262.5126 1452.2186,257.4052 C1448.8942,264.3535 1442.9687,263.9503 1438.6075,258.5478 C1435.1845,263.0509 1429.3245,263.7366 1426.7812,257.5725 C1423.5377,262.5911 1420.5061,262.6909 1416.7461,258.1126 C1413.2171,263.7602 1407.1718,264.0848 1403.1531,258.7169 C1399.549,264.3034 1395.4534,264.4277 1391.3034,259.3219 C1387.3806,264.7447 1383.3065,264.7694 1379.5912,259.1027 C1375.1286,264.5148 1371.2505,264.6504 1367.7346,258.1596 C1365.0242,263.5592 1360.0902,262.5806 1357.6598,257.8802 C1354.4378,263.6599 1348.238,263.1286 1345.0279,257.8665 C1342.3988,262.5188 1336.8575,263.8819 1333.7653,258.3801 C1330.7053,264.5164 1324.9684,263.6587 1322.1323,258.1562 C1317.384,264.1993 1312.8064,263.7705 1309.3517,256.878 C1301.2933,254.167 1297.7111,248.9512 1304.4966,241.5411 C1299.6086,234.0272 1300.8129,228.9573 1309.8995,226.4449" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.7734" x="1315.75" y="245.6641">GitHub Actions (OIDC)</text></g><g class="entity" data-entity="GMN19" data-source-line="26" data-uid="ent0020" id="entity_GMN19"><path d="M2299.97,161.7489 L2299.97,193.3789 L2063.43,197.3789 L2299.97,201.3789 L2299.97,232.9911 A0,0 0 0 0 2299.97,232.9911 L2633.4969,232.9911 A0,0 0 0 0 2633.4969,232.9911 L2633.4969,171.7489 L2623.4969,161.7489 L2299.97,161.7489 A0,0 0 0 0 2299.97,161.7489" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2623.4969,161.7489 L2623.4969,171.7489 L2633.4969,171.7489 L2623.4969,161.7489" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.6099" x="2305.97" y="179.3173">Lambda performs:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.8066" x="2310.0833" y="194.6278">- IP enrichment (geo, ASN)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.4136" x="2310.0833" y="209.9384">- Update blacklist (network ACL / firewall / WAF)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.7646" x="2310.0833" y="225.2489">- Post-process and store artifacts in S3</text></g><!--link Fail2Ban to CWLogs--><g class="link" data-entity-1="Fail2Ban" data-entity-2="CWLogs" data-source-line="16" data-uid="lnk11" id="link_Fail2Ban_CWLogs"><path d="M106.12,141.3789 C188.85,141.3789 350.49,141.3789 449.4,141.3789" fill="none" id="Fail2Ban-to-CWLogs" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="455.4,141.3789,446.4,137.3789,450.4,141.3789,446.4,145.3789,455.4,141.3789" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.3994" x="136.85" y="137.9473">pushes notify events (BLOCKED / Action: ban)</text></g><!--link CWLogs to MetricFilter--><g class="link" data-entity-1="CWLogs" data-entity-2="MetricFilter" data-source-line="17" data-uid="lnk12" id="link_CWLogs_MetricFilter"><path d="M613.18,141.3789 C691.05,141.3789 805.22,141.3789 890.7,141.3789" fill="none" id="CWLogs-to-MetricFilter" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="896.7,141.3789,887.7,137.3789,891.7,141.3789,887.7,145.3789,896.7,141.3789" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.4854" x="643.85" y="137.9473">apply filter -&gt; Notify_Blocks metric</text></g><!--link MetricFilter to Alarm--><g class="link" data-entity-1="MetricFilter" data-entity-2="Alarm" data-source-line="18" data-uid="lnk13" id="link_MetricFilter_Alarm"><path d="M1103.09,141.3789 C1167.08,141.3789 1242.4,141.3789 1302.13,141.3789" fill="none" id="MetricFilter-to-Alarm" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1308.13,141.3789,1299.13,137.3789,1303.13,141.3789,1299.13,145.3789,1308.13,141.3789" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.4619" x="1133.75" y="137.9473">emit metric datapoint</text></g><!--link Alarm to SNS--><g class="link" data-entity-1="Alarm" data-entity-2="SNS" data-source-line="19" data-uid="lnk14" id="link_Alarm_SNS"><path d="M1474.11,135.5189 C1584.6,127.6289 1772.1752,114.2363 1865.2852,107.5863" fill="none" id="Alarm-to-SNS" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1871.27,107.1589,1862.0079,103.8102,1866.2827,107.5151,1862.5778,111.7899,1871.27,107.1589" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9316" x="1560.02" y="112.2373">alarm action (SNS topic)</text></g><!--link SNS to NOTIFIER--><g class="link" data-entity-1="SNS" data-entity-2="NOTIFIER" data-source-line="20" data-uid="lnk15" id="link_SNS_NOTIFIER"><path d="M1978.96,103.3789 C2067.38,103.3789 2241.14,103.3789 2355.73,103.3789" fill="none" id="SNS-to-NOTIFIER" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="2361.73,103.3789,2352.73,99.3789,2356.73,103.3789,2352.73,107.3789,2361.73,103.3789" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.2524" x="2093.97" y="99.9473">email / webhook / ChatOps</text></g><!--link Alarm to Lambda--><g class="link" data-entity-1="Alarm" data-entity-2="Lambda" data-source-line="21" data-uid="lnk16" id="link_Alarm_Lambda"><path d="M1473.97,152.7489 C1486.54,154.3789 1499.37,155.9689 1511.52,157.3789 C1603.42,167.9789 1701.075,177.4714 1781.505,184.8414" fill="none" id="Alarm-to-Lambda" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1787.48,185.3889,1778.8825,180.5843,1782.5009,184.9327,1778.1525,188.551,1787.48,185.3889" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.6665" x="1537.02" y="153.9473">optional invoke for automation</text></g><!--link GHActions to S3--><g class="link" data-entity-1="GHActions" data-entity-2="S3" data-source-line="22" data-uid="lnk17" id="link_GHActions_S3"><path d="M1450.39,264.0789 C1469.53,270.7289 1491.14,277.0489 1511.52,280.3789 C1628.92,299.5189 1761.631,293.5003 1844.631,286.5403" fill="none" id="GHActions-to-S3" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1850.61,286.0389,1841.3072,282.805,1845.6275,286.4567,1841.9757,290.777,1850.61,286.0389" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.6333" x="1547.02" y="276.9473">upload lambda.zip/artifacts</text></g><!--link GHActions to Lambda--><g class="link" data-entity-1="GHActions" data-entity-2="Lambda" data-source-line="23" data-uid="lnk18" id="link_GHActions_Lambda"><path d="M1481.65,237.9889 C1555.73,235.4789 1663.64,230.5489 1757.52,221.3789 C1767.27,220.4189 1771.3732,220.0277 1781.4832,218.8077" fill="none" id="GHActions-to-Lambda" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1787.44,218.0889,1778.0256,215.1959,1782.476,218.6879,1778.984,223.1383,1787.44,218.0889" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.1499" x="1512.52" y="217.9473">deploy / update function via OIDC role</text></g><!--SRC=[PLFDZjem4BxxAKQSG2fTgTmuLCgoooug1LIsubXDaWcnS6pBTa3qr8Ve4_P9EdP2HBitU-QRRxxv2p8eWYLAzUaHDVpvzHiMohGbxAbedGnNU49VvmPT2UFii9_0539Nr39G4Lf7GYYg0WG3JXxh0ALqx9162t-IsgB31chKvOMv0cceK7aEmY8O1wCXxxWsFan6W7xG8hGf2KP9pG53KSFQ77s2B0xn-HxmbOAJ1Iob2kGIihDqXlVuJA5h4YwzUi1-iuStOsMHFFphxSyDAuC7E51U6tFYrmwFVPxDzcsrN3r_ww5hRF8IOOnjCDDScIAYIREKkY7T5zg1H8a1S_GnyOmZN90LTmVojZXHZzpFH966CdgHuRND8KijzZ3UhfuM7URbjJSACNHrEltSzmhcO5jVamTjEC4LwCmwcE1nlLryUNvYULtu77BK4z57HOBx5Z8DMgkkK7LVTcyItu_7MAI79e75Fp6H9FMNewcHeGT1BDmQgOFel14NUyyvqX-J81X7MuZpc8ZuZB1RknDZDvNBC9L5ZM5h_HrhFuuv61ifKO7KPtCYg7W9uumQJ2ixzB3JCkE8rYg39QZ4yF6dj0-t2Vd_u4EIaZZcoa9QooLoabPtbPmbGXmOEAFu1dWIr5-DgMxRSAEnv5XSu-S2-E9MkxljWV6Hp0V8zfj9SdxlqkGAYvEIdlsQmiMu4sIBDSke-2GlgDBgPiikPiVdDhNE5EGzy7c2vtia66hZ1iMj8_P4cU8l]--></g></svg>